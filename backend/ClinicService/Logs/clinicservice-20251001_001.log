2025-10-01 15:15:41.604 -03:00 [WRN] Entity 'Paciente' has a global query filter defined and is the required end of a relationship with the entity 'Consulta'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-10-01 15:15:42.501 -03:00 [INF] Executed DbCommand (80ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-01 15:15:42.525 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-01 15:15:42.612 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-01 15:15:42.674 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-01 15:15:42.675 -03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-01 15:15:42.690 -03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-01 15:15:43.408 -03:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Normalmente é permitida apenas uma utilização de cada endereço de soquete (protocolo/endereço de rede/porta).
 ---> System.Net.Sockets.SocketException (10048): Normalmente é permitida apenas uma utilização de cada endereço de soquete (protocolo/endereço de rede/porta).
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.DefaultAddressStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-10-01 15:16:43.179 -03:00 [WRN] Entity 'Paciente' has a global query filter defined and is the required end of a relationship with the entity 'Consulta'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-10-01 15:16:43.935 -03:00 [INF] Executed DbCommand (90ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-01 15:16:43.963 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-01 15:16:44.050 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-01 15:16:44.121 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-01 15:16:44.121 -03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-01 15:16:44.142 -03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-01 15:16:44.404 -03:00 [INF] Now listening on: http://localhost:5000
2025-10-01 15:16:44.406 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-01 15:16:44.406 -03:00 [INF] Hosting environment: Development
2025-10-01 15:16:44.407 -03:00 [INF] Content root path: C:\anf\clinicmvp\ClinicMVP\backend\ClinicService
2025-10-01 15:16:44.948 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html - null null
2025-10-01 15:16:45.096 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/index.html - 200 null text/html;charset=utf-8 149.6637ms
2025-10-01 15:16:45.317 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - null null
2025-10-01 15:16:45.452 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 135.2635ms
2025-10-01 15:17:00.932 -03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/Pacientes/1 - application/json 21
2025-10-01 15:17:00.942 -03:00 [WRN] Failed to determine the https port for redirect.
2025-10-01 15:17:00.944 -03:00 [INF] CORS policy execution successful.
2025-10-01 15:17:00.947 -03:00 [INF] Executing endpoint 'ClinicService.Controllers.PacientesController.Update (ClinicService)'
2025-10-01 15:17:00.986 -03:00 [INF] Route matched with {action = "Update", controller = "Pacientes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] Update(Int32, ClinicService.DTOs.PacienteUpdateDto, System.Threading.CancellationToken) on controller ClinicService.Controllers.PacientesController (ClinicService).
2025-10-01 15:17:07.211 -03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."DataNascimento", p."DeletedAt", p."DeletedBy", p."Documento", p."Email", p."IsDeleted", p."Nome", p."Telefone"
FROM "Pacientes" AS p
WHERE NOT (p."IsDeleted") AND p."Id" = @__p_0
LIMIT 1
2025-10-01 15:17:07.238 -03:00 [INF] Executing StatusCodeResult, setting HTTP status code 404
2025-10-01 15:17:07.242 -03:00 [INF] Executed action ClinicService.Controllers.PacientesController.Update (ClinicService) in 6252.0586ms
2025-10-01 15:17:07.243 -03:00 [INF] Executed endpoint 'ClinicService.Controllers.PacientesController.Update (ClinicService)'
2025-10-01 15:17:07.251 -03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5000/api/Pacientes/1 - 404 0 null 6319.8048ms
2025-10-01 15:17:18.754 -03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5000/api/Pacientes/1 - null null
2025-10-01 15:17:18.758 -03:00 [INF] CORS policy execution successful.
2025-10-01 15:17:18.758 -03:00 [INF] Executing endpoint 'ClinicService.Controllers.PacientesController.Delete (ClinicService)'
2025-10-01 15:17:18.767 -03:00 [INF] Route matched with {action = "Delete", controller = "Pacientes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] Delete(Int32, System.Threading.CancellationToken) on controller ClinicService.Controllers.PacientesController (ClinicService).
2025-10-01 15:17:22.545 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."DataNascimento", p."DeletedAt", p."DeletedBy", p."Documento", p."Email", p."IsDeleted", p."Nome", p."Telefone"
FROM "Pacientes" AS p
WHERE NOT (p."IsDeleted") AND p."Id" = @__p_0
LIMIT 1
2025-10-01 15:17:22.546 -03:00 [INF] Executing StatusCodeResult, setting HTTP status code 404
2025-10-01 15:17:22.547 -03:00 [INF] Executed action ClinicService.Controllers.PacientesController.Delete (ClinicService) in 3778.89ms
2025-10-01 15:17:22.547 -03:00 [INF] Executed endpoint 'ClinicService.Controllers.PacientesController.Delete (ClinicService)'
2025-10-01 15:17:22.548 -03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5000/api/Pacientes/1 - 404 0 null 3793.3393ms
2025-10-01 15:17:39.971 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Audit/pacientes/1 - null null
2025-10-01 15:17:39.973 -03:00 [INF] Executing endpoint 'ClinicService.Controllers.AuditController.GetPacienteHistory (ClinicService)'
2025-10-01 15:17:39.981 -03:00 [INF] Route matched with {action = "GetPacienteHistory", controller = "Audit"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[ClinicService.Models.AuditLog]]] GetPacienteHistory(Int32, System.Threading.CancellationToken) on controller ClinicService.Controllers.AuditController (ClinicService).
2025-10-01 15:17:40.016 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__entityName_0='?', @__key_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Action", a."ChangedAtUtc", a."ChangedBy", a."Entity", a."EntityId", a."NewValues", a."OldValues", a."RequestId"
FROM "AuditLogs" AS a
WHERE a."Entity" = @__entityName_0 AND a."EntityId" = @__key_1
ORDER BY a."ChangedAtUtc" DESC
2025-10-01 15:17:40.048 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ClinicService.Models.AuditLog, ClinicService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-01 15:17:40.064 -03:00 [INF] Executed action ClinicService.Controllers.AuditController.GetPacienteHistory (ClinicService) in 82.3544ms
2025-10-01 15:17:40.064 -03:00 [INF] Executed endpoint 'ClinicService.Controllers.AuditController.GetPacienteHistory (ClinicService)'
2025-10-01 15:17:40.064 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/Audit/pacientes/1 - 200 null application/json; charset=utf-8 92.7192ms
2025-10-01 15:18:05.661 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Audit/1/1 - null null
2025-10-01 15:18:05.662 -03:00 [INF] Executing endpoint 'ClinicService.Controllers.AuditController.GetHistory (ClinicService)'
2025-10-01 15:18:05.667 -03:00 [INF] Route matched with {action = "GetHistory", controller = "Audit"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[ClinicService.Models.AuditLog]]] GetHistory(System.String, System.String, System.Threading.CancellationToken) on controller ClinicService.Controllers.AuditController (ClinicService).
2025-10-01 15:18:05.683 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__entity_0='?', @__entityId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Action", a."ChangedAtUtc", a."ChangedBy", a."Entity", a."EntityId", a."NewValues", a."OldValues", a."RequestId"
FROM "AuditLogs" AS a
WHERE a."Entity" = @__entity_0 AND a."EntityId" = @__entityId_1
ORDER BY a."ChangedAtUtc" DESC
2025-10-01 15:18:05.686 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ClinicService.Models.AuditLog, ClinicService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-01 15:18:05.687 -03:00 [INF] Executed action ClinicService.Controllers.AuditController.GetHistory (ClinicService) in 19.9736ms
2025-10-01 15:18:05.687 -03:00 [INF] Executed endpoint 'ClinicService.Controllers.AuditController.GetHistory (ClinicService)'
2025-10-01 15:18:05.687 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/Audit/1/1 - 200 null application/json; charset=utf-8 26.3592ms
2025-10-01 15:18:14.336 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Audit/paciente/1 - null null
2025-10-01 15:18:14.337 -03:00 [INF] Executing endpoint 'ClinicService.Controllers.AuditController.GetHistory (ClinicService)'
2025-10-01 15:18:14.337 -03:00 [INF] Route matched with {action = "GetHistory", controller = "Audit"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[ClinicService.Models.AuditLog]]] GetHistory(System.String, System.String, System.Threading.CancellationToken) on controller ClinicService.Controllers.AuditController (ClinicService).
2025-10-01 15:18:14.343 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__entity_0='?', @__entityId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Action", a."ChangedAtUtc", a."ChangedBy", a."Entity", a."EntityId", a."NewValues", a."OldValues", a."RequestId"
FROM "AuditLogs" AS a
WHERE a."Entity" = @__entity_0 AND a."EntityId" = @__entityId_1
ORDER BY a."ChangedAtUtc" DESC
2025-10-01 15:18:14.345 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ClinicService.Models.AuditLog, ClinicService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-01 15:18:14.345 -03:00 [INF] Executed action ClinicService.Controllers.AuditController.GetHistory (ClinicService) in 7.7712ms
2025-10-01 15:18:14.345 -03:00 [INF] Executed endpoint 'ClinicService.Controllers.AuditController.GetHistory (ClinicService)'
2025-10-01 15:18:14.345 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/Audit/paciente/1 - 200 null application/json; charset=utf-8 9.5298ms
2025-10-01 15:24:21.788 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Audit/Paciente/3 - null null
2025-10-01 15:24:21.820 -03:00 [INF] Executing endpoint 'ClinicService.Controllers.AuditController.GetHistory (ClinicService)'
2025-10-01 15:24:21.821 -03:00 [INF] Route matched with {action = "GetHistory", controller = "Audit"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[ClinicService.Models.AuditLog]]] GetHistory(System.String, System.String, System.Threading.CancellationToken) on controller ClinicService.Controllers.AuditController (ClinicService).
2025-10-01 15:24:21.944 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__entity_0='?', @__entityId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Action", a."ChangedAtUtc", a."ChangedBy", a."Entity", a."EntityId", a."NewValues", a."OldValues", a."RequestId"
FROM "AuditLogs" AS a
WHERE a."Entity" = @__entity_0 AND a."EntityId" = @__entityId_1
ORDER BY a."ChangedAtUtc" DESC
2025-10-01 15:24:21.944 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ClinicService.Models.AuditLog, ClinicService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-01 15:24:21.945 -03:00 [INF] Executed action ClinicService.Controllers.AuditController.GetHistory (ClinicService) in 123.6435ms
2025-10-01 15:24:21.945 -03:00 [INF] Executed endpoint 'ClinicService.Controllers.AuditController.GetHistory (ClinicService)'
2025-10-01 15:24:21.945 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/Audit/Paciente/3 - 200 null application/json; charset=utf-8 157.2888ms
